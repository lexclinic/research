<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>LexClinic Research</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/github-markdown-css/github-markdown.css">
  <style>
    body { font-family: sans-serif; margin: 20px; }
    h1 { font-size: 2em; }
    .memo { margin-bottom: 1em; }
    .memo a { font-size: 1.2em; color: #0366d6; text-decoration: none; }
    .memo a:hover { text-decoration: underline; }
    .memo p { margin: 0.5em 0; }
  </style>
</head>
<body class="markdown-body">
  <h1>LexClinic Research</h1>
  <p>Welcome to our collection of research memos. Below is a list of our published memos:</p>
  <div id="memo-list"></div>

  <script>
    const memoList = document.getElementById('memo-list');
    const baseUrl = 'https://raw.githubusercontent.com/lexclinic/research/main/';

    async function fetchMemoList() {
      try {
        const response = await fetch(baseUrl);
        const text = await response.text();
        const fileNames = text.match(/href="([^"]+\.md)"/g)
          .map(link => link.match(/href="([^"]+\.md)"/)[1])
          .filter(name => !name.includes('/')); // Exclude subdirectories

        const subdirResponse = await fetch(baseUrl + 'signatures/');
        const subdirText = await subdirResponse.text();
        const subdirFileNames = subdirText.match(/href="([^"]+\.md)"/g)
          .map(link => link.match(/href="([^"]+\.md)"/)[1])
          .map(name => 'signatures/' + name);

        const allFileNames = [...fileNames, ...subdirFileNames];

        allFileNames.forEach(fileName => {
          const memo = document.createElement('div');
          memo.classList.add('memo');
          const memoLink = document.createElement('a');
          memoLink.href = baseUrl + fileName;
          memoLink.textContent = fileName.replace(/\.md$/, '').replace(/_/g, ' ');
          memo.appendChild(memoLink);
          memoList.appendChild(memo);
        });
      } catch (error) {
        console.error('Error fetching memo list:', error);
        memoList.innerHTML = '<p>Failed to load memo list. Please try again later.</p>';
      }
    }

    fetchMemoList();
  </script>
</body>
</html>
